=============================================================
====    written by Maurits W. Haverkort,                 ====
====    Yi Lu, Robert Green, Sebastian Macke,            ====
====    Marius Retegan, Martin Brass, and Simon Heinze   ====
====    (cc) 1995 - 2022 code and binaries released      ====
====    under creative commons CC-BY lisence             ====
====    www.quanty.org                                   ====
====    Beta version, be critical and report errors!!!   ====
=============================================================
====    Version 0.7 beta                                 ====
====            compiled at: May 16 2023 at 15:19:14     ====
=============================================================
====    When used in scientific publications please cite ====
====    one of the following papers as appropriate with  ====
====    respect to the methods used in your publication: ====
====    Phys. Rev. B 85, 165113 (2012)                   ====
====    Phys. Rev. B 90, 085102 (2014)                   ====
====    Euro Phys. Lett. 108, 57004 (2014)               ====
====    J. of Phys.: Conf. Series 712, 012001 (2016)     ====
====    New Journal of Physics 22 (9), 093018 (2020)     ====
=============================================================
Program executed on: Wed May 21 15:32:54 2025
Running on host    : macchiato.phys.washington.edu
number of available processors              : 48
maximum number of threads in parallel region: 4
Smallest positive float  : 2.225074E-308 
Smallest deviation from 1: 2.220446E-16 

--Read FPLO output--

--Create the Tight Binding Hamiltonian--

Create the tight binding Hamiltonian for the crystal


 Temp Cluster
{ { Ni , 
  { 0 , 0 , 0 } , 
  { { 3d , 
  { d_{xy} , d_{yz} , d_{3z^2-r^2} , d_{xz} , d_{x^2-y^2} } } } } , 
  { O , 
  { 0 , 0 , -3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , -3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { -3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 0 , 3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } }

 Cluster Sorted
{ { Ni , 
  { 0 , 0 , 0 } , 
  { { 3d , 
  { d_{xy} , d_{yz} , d_{3z^2-r^2} , d_{xz} , d_{x^2-y^2} } } } } , 
  { O , 
  { 0 , 0 , -3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , -3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { -3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 0 , 3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } }
     dxy      dxy      dyz      dyz      dz^2     dz^2     dxz      dxz      dx2y2    dx2y2
{ { -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  } ,
  {  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  } }

20
28
The indices of the system are now fixed:
{ Ni_1s_Up = { 27 } ,
  Ligand_d = { 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 } ,
  Ni_2p_Up = { 21 , 23 , 25 } ,
  all = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 } ,
  Ni_3d_Up = { 1 , 3 , 5 , 7 , 9 } ,
  Ni_3d_Dn = { 0 , 2 , 4 , 6 , 8 } ,
  Ligand_d_Dn = { 10 , 12 , 14 , 16 , 18 } ,
  Ni_1s_Dn = { 26 } ,
  Ni_3d = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 } ,
  Ligand_d_Up = { 11 , 13 , 15 , 17 , 19 } ,
  Ni_2p_Dn = { 20 , 22 , 24 } ,
  All = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 } ,
  Ni_2p = { 20 , 21 , 22 , 23 , 24 , 25 } ,
  Ni_1s = { 26 , 27 } ,
  Ni = { 20 , 21 , 22 , 23 , 24 , 25 , 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 26 , 27 } }

Create the Coulomb operator for the d-shell

Create the Coulomb operator for the s-shell

Create the Coulomb operator between the p- and d-shell

Create the Coulomb operator for the d-shell using the mean-field approximation (needs the DFT density)

--Set the parameters--

Parameters:
nd = 8
Delta fit to exp = 2 eV
Udd fit to exp= 5 eV
Upd fit to exp = 6 eV
Usd fit to exp = 6.5 eV
Bz = 0 eV
Hx = 0 eV
Hy = 0 eV
Hz = 0 eV
zeta_3d = 0.082586623136141 eV
zeta_2p = 11.505663567558 eV

Slater integrals computed from DFT radial wavefunctions:
F0sd ab initio = 37.025050091875 eV
F0dd ab initio = 25.870685450478 eV
F2dd = 11.691083504322 eV
F4dd = 7.2214068575626 eV
F0pd ab initio = 36.80674699588 eV
F2pd = 6.9241935340766 eV
G1pd = 5.1498818159701 eV
G3pd = 2.9266354717674 eV
G2sd = 0.060198436430129 eV

Monopole like Slater integrals (from U):
F0dd fit to exp = 5.6003965194249 eV
F0pd fit to exp = 6.4687526889023 eV
F0sd fit to exp = 6.5 eV


Warning: Without a specified density the matrix representation can only be found for the quadratic part of an operator, all other parts will be ignored.
--Define some additional operators--

--Define 1s Core Hole State Hamiltonian--

--Define XAS-Hamiltonian--

edgs = -28.888888888889 eV
eLgs = 9.1111111111111 eV
edinter = -36.111111111111 eV
eLinter = 14.888888888889 eV
edfinal = -48.888888888889 eV
eLfinal = 25.111111111111 eV

--Compute Ground State eigenstates--
Npsi	5

Ground State Start Restrictions
{ 28 , 0 , 
  { 0000000000000000000000000011 , 2 , 2 } , 
  { 1111111111111111111100000000 , 18 , 18 } , 
  { 0000000000000000000011111100 , 6 , 6 } }
Start of BlockGroundState. Converge 5 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerialRestricted
Outer loop   1, Number of Determinants:       173       190 last variance  1.635322816748521E+01
Start of BlockOperatorPsiSerialRestricted
Start of BlockGroundState. Converge 5 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerial

dZ
1.3136526123736e-18

--Compute 1s Corehole eigenstates--
Npsi	5

1s Corehole Start Restrictions
{ 28 , 0 , 
  { 0000000000000000000000000011 , 1 , 1 } , 
  { 1111111111111111111100000000 , 18 , 18 } , 
  { 0000000000000000000011111100 , 6 , 6 } }
Start of BlockGroundState. Converge 5 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerialRestricted
Outer loop   1, Number of Determinants:       318       379 last variance  9.388231145952886E+00
Start of BlockOperatorPsiSerialRestricted
Start of BlockGroundState. Converge 5 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerial

dZ
0.60347574232127

--Compute eigenstates--
Npsi
9
Start of BlockGroundState. Converge 9 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerialRestricted
Outer loop   1, Number of Determinants:       348       380 last variance  8.955042918809340E+00
Start of BlockOperatorPsiSerialRestricted
Start of BlockGroundState. Converge 9 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerial

dZ
0.0018071268805251

--Ground State Expectation Values--

           <E>       <S_z^3d>  <L_z^3d>  <J_z^3d>  <S^2>     <L^2>     <J^2>     <3d_yz>   <3d_xz>   <3x_xy>   <3d_x2y2> <3x_z2>   <N_Ni_d>  <N_Ni>    <N_L>     
 1         161.793  -0.797221 -0.225495 -1.02272   1.55545   9.8195    12.2094   1.9976    1.99776   1.99602   1.18661   1.1854    8.36339   16.3634   9.63661  
 2         161.793  -0.003273 -9.257e-4 -0.004198  1.55545   9.8195    12.2094   1.99602   1.99601   1.99934   1.18479   1.18722   8.36339   16.3634   9.63661  
 3         161.793   0.800494  0.22642   1.02691   1.55545   9.8195    12.2094   1.99776   1.99761   1.99601   1.18662   1.18539   8.36339   16.3634   9.63661  
 4         162.832   0         0         0         1.58359   10.2529   14.0457   1.93412   1.43915   1.74285   1.55548   1.6098    8.2814    16.2814   9.7186   
 5         162.832   0         0         0         1.58359   10.2529   14.0457   1.47663   1.97159   1.6679    1.6098    1.55548   8.2814    16.2814   9.7186   

--1s Corehole State Expectation Values--

           <E>       <S_z^3d>  <L_z^3d>  <J_z^3d>  <S^2>     <L^2>     <J^2>     <3d_yz>   <3d_xz>   <3x_xy>   <3d_x2y2> <3x_z2>   <N_Ni_d>  <N_Ni>    <N_L>     
 1         156.531  -0.34706  -0.042899 -0.389959  0.574958  4.25719   4.96801   1.99971   1.99971   1.99967   1.64569   1.64569   9.29046   16.2905   8.70953  
 2         156.531   0.117834  0.014567  0.1324    0.574958  4.25719   4.96801   1.99968   1.99968   1.99972   1.64569   1.64569   9.29046   16.2905   8.70953  
 3         156.531  -0.117808 -0.014564 -0.132372  0.574958  4.25719   4.96801   1.99968   1.99968   1.99972   1.64569   1.64569   9.29046   16.2905   8.70953  
 4         156.531   0.347035  0.042896  0.389931  0.574958  4.25719   4.96801   1.99971   1.99971   1.99966   1.64569   1.64569   9.29046   16.2905   8.70953  
 5         156.544   0.232988  0.028784  0.261773  0.572573  4.24109   4.94965   1.99969   1.99969   1.99969   1.64704   1.64704   9.29315   16.2931   8.70685  
 6         156.544  -0.232988 -0.028784 -0.261773  0.572573  4.24109   4.94965   1.99969   1.99969   1.99969   1.64704   1.64704   9.29315   16.2931   8.70685  
 7         156.691  -8.781e-4 -1.759e-4 -0.001054  0.403038  3.78694   4.29079   1.99954   1.99954   1.99965   1.68187   1.68186   9.36246   16.3625   8.63754  
 8         156.691  -1.088e-4 -2.012e-5 -1.289e-4  0.403038  3.78694   4.29079   1.99957   1.99964   1.99952   1.68186   1.68187   9.36246   16.3625   8.63754  
 9         156.691   9.44e-4   1.868e-4  0.001131  0.403038  3.78694   4.29079   1.99962   1.9995    1.99961   1.68187   1.68187   9.36246   16.3625   8.63754  
