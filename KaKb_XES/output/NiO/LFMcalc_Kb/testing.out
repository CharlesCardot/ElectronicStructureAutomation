=============================================================
====    written by Maurits W. Haverkort,                 ====
====    Yi Lu, Robert Green, Sebastian Macke,            ====
====    Marius Retegan, Martin Brass, and Simon Heinze   ====
====    (cc) 1995 - 2022 code and binaries released      ====
====    under creative commons CC-BY lisence             ====
====    www.quanty.org                                   ====
====    Beta version, be critical and report errors!!!   ====
=============================================================
====    Version 0.7 beta                                 ====
====            compiled at: May 16 2023 at 15:19:14     ====
=============================================================
====    When used in scientific publications please cite ====
====    one of the following papers as appropriate with  ====
====    respect to the methods used in your publication: ====
====    Phys. Rev. B 85, 165113 (2012)                   ====
====    Phys. Rev. B 90, 085102 (2014)                   ====
====    Euro Phys. Lett. 108, 57004 (2014)               ====
====    J. of Phys.: Conf. Series 712, 012001 (2016)     ====
====    New Journal of Physics 22 (9), 093018 (2020)     ====
=============================================================
Program executed on: Wed May 21 17:50:04 2025
Running on host    : macchiato.phys.washington.edu
number of available processors              : 48
maximum number of threads in parallel region: 4
Smallest positive float  : 2.225074E-308 
Smallest deviation from 1: 2.220446E-16 

--Read FPLO output--

--Create the Tight Binding Hamiltonian--

Create the tight binding Hamiltonian for the crystal


 Temp Cluster
{ { Ni , 
  { 0 , 0 , 0 } , 
  { { 3d , 
  { d_{xy} , d_{yz} , d_{3z^2-r^2} , d_{xz} , d_{x^2-y^2} } } } } , 
  { O , 
  { 0 , 0 , -3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , -3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { -3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 0 , 3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } }

 Cluster Sorted
{ { Ni , 
  { 0 , 0 , 0 } , 
  { { 3d , 
  { d_{xy} , d_{yz} , d_{3z^2-r^2} , d_{xz} , d_{x^2-y^2} } } } } , 
  { O , 
  { 0 , 0 , -3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , -3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { -3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 0 , 3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } }
     dxy      dxy      dyz      dyz      dz^2     dz^2     dxz      dxz      dx2y2    dx2y2
{ { -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  } ,
  {  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  } }

20
28
The indices of the system are now fixed:
{ Ni_1s_Dn = { 26 } ,
  Ni_3d = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 } ,
  all = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 } ,
  Ni = { 20 , 21 , 22 , 23 , 24 , 25 , 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 26 , 27 } ,
  Ni_1s = { 26 , 27 } ,
  Ni_3d_Up = { 1 , 3 , 5 , 7 , 9 } ,
  All = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 } ,
  Ni_3p_Dn = { 20 , 22 , 24 } ,
  Ni_3p = { 20 , 21 , 22 , 23 , 24 , 25 } ,
  Ni_3p_Up = { 21 , 23 , 25 } ,
  Ni_3d_Dn = { 0 , 2 , 4 , 6 , 8 } ,
  Ni_1s_Up = { 27 } ,
  Ligand_d_Dn = { 10 , 12 , 14 , 16 , 18 } ,
  Ligand_d = { 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 } ,
  Ligand_d_Up = { 11 , 13 , 15 , 17 , 19 } }

--Subtract the DFT Mean-field Coulomb interaction between the d electrons from the tight-binding Hamiltonian--

Calculate the DFT 1-particle density matrix

{ { 0.9895874414103 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0.9895874414103 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0.98958744141031 , 0 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0.98958744141031 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0.6650661519633 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0.6650661519633 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0.9895874414103 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0.9895874414103 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0.66506615196324 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0.66506615196324 } }
Create the Coulomb operator for the d-shell

Create the Coulomb operator for the s-shell

Create the Coulomb operator between the p- and d-shell

Create the Coulomb operator for the d-shell using the mean-field approximation (needs the DFT density)

--Set the parameters--

Parameters:
nd = 8
Delta fit to exp = 2 eV
Udd fit to exp= 5 eV
Upd fit to exp = 6.25 eV
Usd fit to exp = 6.5 eV
Bz = 5.7883818011084e-06 eV
Hx = 0 eV
Hy = 0 eV
Hz = 0 eV
zeta_3d = 0.082586623136141 eV
zeta_3p = 1.3993466539625 eV

Slater integrals computed from DFT radial wavefunctions:
F0sd ab initio = 37.025050091875 eV
F0dd ab initio = 25.870685450478 eV
F2dd = 11.691083504322 eV
F4dd = 7.2214068575626 eV
F0pd ab initio = 28.354477281717 eV
F2pd = 13.165572672769 eV
G1pd = 16.286603702333 eV
G3pd = 9.8179088684992 eV
G2sd = 0.060198436430129 eV

Monopole like Slater integrals (from U):
F0dd fit to exp = 5.6003965194249 eV
F0pd fit to exp = 7.7565411030912 eV
F0sd fit to exp = 6.5 eV


Warning: Without a specified density the matrix representation can only be found for the quadratic part of an operator, all other parts will be ignored.
--Define some additional operators--

--Define 1s Core Hole State Hamiltonian--

--Define XAS-Hamiltonian--

edinter = -36.111111111111 eV
eLinter = 14.888888888889 eV
edfinal = -49.722222222222 eV
eLfinal = 25.777777777778 eV

--Compute 1s Corehole eigenstates--
Npsi	5

1s Corehole Start Restrictions
{ 28 , 0 , 
  { 0000000000000000000000000011 , 1 , 1 } , 
  { 1111111111111111111100000000 , 18 , 18 } , 
  { 0000000000000000000011111100 , 6 , 6 } }
Start of BlockGroundState. Converge 5 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerialRestricted
Outer loop   1, Number of Determinants:       324       379 last variance  9.722252363000734E+00
Start of BlockOperatorPsiSerialRestricted
Start of BlockGroundState. Converge 5 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerial

dZ
0.60344105550773

--Compute eigenstates--
Npsi
9
Start of BlockGroundState. Converge 9 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerialRestricted
Outer loop   1, Number of Determinants:       351       380 last variance  9.390896370689006E+00
Start of BlockOperatorPsiSerialRestricted
Start of BlockGroundState. Converge 9 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerial

dZ
0.0018068144918934

--1s Corehole State Expectation Values--

           <E>       <S_z^3d>  <L_z^3d>  <J_z^3d>  <S^2>     <L^2>     <J^2>     <3d_yz>   <3d_xz>   <3x_xy>   <3d_x2y2> <3x_z2>   <N_Ni_d>  <N_Ni>    <N_L>     
 1         156.531  -0.35418  -0.043785 -0.397965  0.574959  4.2572    4.96802   1.99971   1.99971   1.99966   1.64569   1.64569   9.29046   16.2905   8.70954  
 2         156.531  -0.118114 -0.014608 -0.132722  0.574959  4.2572    4.96801   1.99968   1.99968   1.99972   1.64569   1.64569   9.29046   16.2905   8.70953  
 3         156.531   0.118006  0.014582  0.132588  0.574958  4.25719   4.968     1.99968   1.99968   1.99972   1.64569   1.64569   9.29046   16.2905   8.70953  
 4         156.531   0.354179  0.043773  0.397952  0.574957  4.25719   4.96799   1.99971   1.99971   1.99966   1.64569   1.64569   9.29047   16.2905   8.70953  
 5         156.544  -0.236072 -0.029172 -0.265244  0.572574  4.24109   4.94966   1.99969   1.99969   1.99969   1.64704   1.64704   9.29315   16.2931   8.70685  
 6         156.544   0.236177  0.029172  0.265349  0.572573  4.24108   4.94964   1.99969   1.99969   1.99969   1.64704   1.64704   9.29315   16.2931   8.70685  
 7         156.691  -9.464e-4 -1.945e-4 -0.001141  0.403038  3.78694   4.29079   1.99953   1.99953   1.99965   1.68187   1.68186   9.36246   16.3625   8.63754  
 8         156.691  -9.465e-4 -1.87e-4  -0.001133  0.403038  3.78694   4.29079   1.99961   1.99961   1.9995    1.68186   1.68187   9.36246   16.3625   8.63754  
 9         156.691   9.445e-4  1.765e-4  0.001121  0.403038  3.78694   4.29079   1.99961   1.99961   1.9995    1.68186   1.68187   9.36246   16.3625   8.63754  

--Create the XES Spectra--

1
0.99988504097889
0.99977010619447
0.99965519816317
0.60344105592141
0.60330233745166
0.0018068161780993
Spectra printed to file: XES_sticks.dat
Spectra printed to file: XES.dat
Spectra printed to file: XES_zpol.dat
Spectra printed to file: XES_xpol.dat
Spectra printed to file: XES_ypol.dat
Finished
