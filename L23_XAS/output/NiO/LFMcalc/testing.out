=============================================================
====    written by Maurits W. Haverkort,                 ====
====    Yi Lu, Robert Green, Sebastian Macke,            ====
====    Marius Retegan, Martin Brass, and Simon Heinze   ====
====    (cc) 1995 - 2022 code and binaries released      ====
====    under creative commons CC-BY lisence             ====
====    www.quanty.org                                   ====
====    Beta version, be critical and report errors!!!   ====
=============================================================
====    Version 0.7 beta                                 ====
====            compiled at: May 16 2023 at 15:19:14     ====
=============================================================
====    When used in scientific publications please cite ====
====    one of the following papers as appropriate with  ====
====    respect to the methods used in your publication: ====
====    Phys. Rev. B 85, 165113 (2012)                   ====
====    Phys. Rev. B 90, 085102 (2014)                   ====
====    Euro Phys. Lett. 108, 57004 (2014)               ====
====    J. of Phys.: Conf. Series 712, 012001 (2016)     ====
====    New Journal of Physics 22 (9), 093018 (2020)     ====
=============================================================
Program executed on: Wed May 21 18:17:49 2025
Running on host    : macchiato.phys.washington.edu
number of available processors              : 48
maximum number of threads in parallel region: 4
Smallest positive float  : 2.225074E-308 
Smallest deviation from 1: 2.220446E-16 

--Read FPLO output--

--Create the Tight Binding Hamiltonian--

Create the tight binding Hamiltonian for the crystal


 Temp Cluster
{ { Ni , 
  { 0 , 0 , 0 } , 
  { { 3d , 
  { d_{xy} , d_{yz} , d_{3z^2-r^2} , d_{xz} , d_{x^2-y^2} } } } } , 
  { O , 
  { 0 , 0 , -3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , -3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { -3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 0 , 3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } }

 Cluster Sorted
{ { Ni , 
  { 0 , 0 , 0 } , 
  { { 3d , 
  { d_{xy} , d_{yz} , d_{3z^2-r^2} , d_{xz} , d_{x^2-y^2} } } } } , 
  { O , 
  { 0 , 0 , -3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , -3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { -3.9841280897427 , 0 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 3.9841280897427 , 0 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } , 
  { O , 
  { 0 , 0 , 3.9841280897427 } , 
  { { 2p , 
  { p_y , p_z , p_x } } } } }
{ { -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.269 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -1.085 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  } ,
  {  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  1.168 ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -5.223 ,  0     ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  ,  0     } ,
  {  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  2.04  ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     ,  0     , -3.77  } }

20
26
The indices of the system are now fixed:
{ Ni_2p_Dn = { 20 , 22 , 24 } ,
  Ni = { 20 , 21 , 22 , 23 , 24 , 25 , 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 } ,
  All = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 } ,
  Ni_2p = { 20 , 21 , 22 , 23 , 24 , 25 } ,
  all = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 } ,
  Ni_3d_Up = { 1 , 3 , 5 , 7 , 9 } ,
  Ni_3d = { 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 } ,
  Ni_3d_Dn = { 0 , 2 , 4 , 6 , 8 } ,
  Ni_2p_Up = { 21 , 23 , 25 } ,
  Ligand_d = { 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 } ,
  Ligand_d_Dn = { 10 , 12 , 14 , 16 , 18 } ,
  Ligand_d_Up = { 11 , 13 , 15 , 17 , 19 } }

--Subtract the DFT Mean-field Coulomb interaction between the d electrons from the tight-binding Hamiltonian--

Calculate the DFT 1-particle density matrix

{ { 0.9895874414103 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0.9895874414103 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0.98958744141031 , 0 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0.98958744141031 , 0 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0.6650661519633 , 0 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0.6650661519633 , 0 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0.9895874414103 , 0 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0.9895874414103 , 0 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0.66506615196324 , 0 } , 
  { 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0.66506615196324 } }
Create the Coulomb operator for the d-shell

Create the Coulomb operator between the p- and d-shell

Create the Coulomb operator for the d-shell using the mean-field approximation (needs the DFT density)

--Set the parameters--

Parameters:
nd = 8
Delta fit to exp = 2 eV
Udd fit to exp= 5 eV
Upd fit to exp = 6 eV
Bz = 5.7883818011084e-06 eV
zeta_3d = 0.082586623136141 eV
zeta_2p = 11.505663567558 eV

Slater integrals computed from DFT radial wavefunctions:
F0dd ab initio = 25.870685450478 eV
F2dd = 11.691083504322 eV
F4dd = 7.2214068575626 eV
F0pd ab initio = 36.80674699588 eV
F2pd = 6.9241935340766 eV
G1pd = 5.1498818159701 eV
G3pd = 2.9266354717674 eV

Monopole like Slater integrals (from U):
F0dd fit to exp = 5.6003965194249 eV
F0pd fit to exp = 6.4687526889023 eV


Warning: Without a specified density the matrix representation can only be found for the quadratic part of an operator, all other parts will be ignored.
--Define some additional operators--

--Define Intermediate State Hamiltonian--

--Define XAS-Hamiltonian--

edinit = -28.888888888889 eV
eLinit = 9.1111111111111 eV
edfinal = -54.166666666667 eV
eLfinal = 19.833333333333 eV

--Compute eigenstates--
Npsi
21
Start of BlockGroundState. Converge 21 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerialRestricted
Outer loop   1, Number of Determinants:       190       190 last variance  1.332775097496778E+01
Start of BlockOperatorPsiSerialRestricted
Start of BlockGroundState. Converge 21 states to an energy with relative variance smaller than  1.000000000000000E-06

Start of BlockOperatorPsiSerial
{ 26 , 0 , 
  { 11111111111111111111000000 , 18 , 18 } , 
  { 00000000000000000000111111 , 6 , 6 } }

dZ
3.6299629489664e-32

--Initial State Energies--
{ 161.79275368525 , 161.79276443816 , 161.79277519108 , 162.8323505463 , 162.83235055287 , 162.86152464136 , 162.86153003945 , 162.86153542379 , 162.90829738864 , 162.90830336916 , 162.9083093551 , 162.92760811954 , 163.09889286311 , 163.09889286319 , 163.47532207344 , 163.54344002868 , 163.54344142571 , 163.5434428179 , 163.62059455144 , 163.62059782484 , 163.62060110078 }

--Create the Spectra--

1
0.99957421225064
0.99914860546132
1.3130936433036e-18
Spectra printed to file: XAS_sticks.dat
Spectra printed to file: XAS.dat
Spectra printed to file: XAS_zpol_sticks.dat
Spectra printed to file: XAS_xpol_sticks.dat
Spectra printed to file: XAS_ypol_sticks.dat
Spectra printed to file: XAS_rpol_zdir_sticks.dat
Spectra printed to file: XAS_lpol_zdir_sticks.dat
Spectra printed to file: XAS_rpol_ydir_sticks.dat
Spectra printed to file: XAS_lpol_ydir_sticks.dat
Spectra printed to file: XAS_rpol_xdir_sticks.dat
Spectra printed to file: XAS_lpol_xdir_sticks.dat
Spectra printed to file: XAS_zpol.dat
Spectra printed to file: XAS_xpol.dat
Spectra printed to file: XAS_ypol.dat
Spectra printed to file: XAS_rpol_zdir.dat
Spectra printed to file: XAS_lpol_zdir.dat
Spectra printed to file: XAS_rpol_ydir.dat
Spectra printed to file: XAS_lpol_ydir.dat
Spectra printed to file: XAS_rpol_xdir.dat
Spectra printed to file: XAS_lpol_xdir.dat
Finished
